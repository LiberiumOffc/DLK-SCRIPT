-- Murder Mystery 2 Script —Å WindUI
local WindUI = loadstring(game:HttpGet("https://github.com/Footagesus/WindUI/releases/latest/download/main.lua"))()

-- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
local Config = {
    ESP = {
        Murder = true,
        Sheriff = true,
        Innocent = true,
        Gun = true
    },
    Murder = {
        KillAll = false,
        KillSheriff = false,
        TeleportSheriff = false
    },
    Sheriff = {
        KillMurder = false,
        TeleportMurder = false
    },
    Innocent = {
        AutoGrabGun = false,
        TakeMurderChat = false,
        TakeSheriffChat = false
    },
    Misc = {
        FlingPlayer = "",
        FlingAll = false,
        ServerHop = false,
        Rejoin = false
    }
}

-- –¶–≤–µ—Ç–∞ ESP
local ESPColors = {
    Murder = Color3.fromRGB(255, 0, 0),
    Sheriff = Color3.fromRGB(0, 0, 255),
    Innocent = Color3.fromRGB(0, 255, 0),
    Gun = Color3.fromRGB(0, 100, 255)
}

-- –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
local function GetPlayers()
    return game:GetService("Players"):GetPlayers()
end

local function GetCharacter(player)
    return player.Character
end

local function GetHumanoid(player)
    local char = GetCharacter(player)
    return char and char:FindFirstChild("Humanoid")
end

local function IsMurder(player)
    local char = GetCharacter(player)
    if char then
        local knife = char:FindFirstChild("Knife")
        if knife then
            return true
        end
    end
    return false
end

local function IsSheriff(player)
    local char = GetCharacter(player)
    if char then
        local gun = char:FindFirstChild("Gun")
        if gun and gun:IsA("Tool") then
            return true
        end
    end
    return false
end

local function FindGun()
    for _, item in pairs(workspace:GetChildren()) do
        if item.Name == "GunDrop" and item:IsA("Model") then
            local gun = item:FindFirstChild("Gun")
            if gun then
                return gun
            end
        end
    end
    return nil
end

-- ESP —Å–∏—Å—Ç–µ–º–∞
local ESP = {
    Objects = {}
}

function ESP:Add(obj, color, text)
    if self.Objects[obj] then return end
    
    local highlight = Instance.new("Highlight")
    highlight.Adornee = obj
    highlight.FillColor = color
    highlight.OutlineColor = color
    highlight.FillTransparency = 0.3
    highlight.OutlineTransparency = 0
    highlight.Parent = obj
    
    local billboard = Instance.new("BillboardGui")
    billboard.Size = UDim2.new(0, 200, 0, 50)
    billboard.Adornee = obj
    billboard.AlwaysOnTop = true
    billboard.ExtentsOffset = Vector3.new(0, 3, 0)
    
    local label = Instance.new("TextLabel")
    label.Size = UDim2.new(1, 0, 1, 0)
    label.BackgroundTransparency = 1
    label.Text = text
    label.TextColor3 = color
    label.TextScaled = true
    label.Font = Enum.Font.GothamBold
    label.Parent = billboard
    billboard.Parent = obj
    
    self.Objects[obj] = {
        Highlight = highlight,
        Billboard = billboard
    }
end

function ESP:Remove(obj)
    if self.Objects[obj] then
        self.Objects[obj].Highlight:Destroy()
        self.Objects[obj].Billboard:Destroy()
        self.Objects[obj] = nil
    end
end

function ESP:Clear()
    for obj, _ in pairs(self.Objects) do
        self:Remove(obj)
    end
end

function ESP:Update()
    -- –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã–µ ESP
    for obj, data in pairs(self.Objects) do
        if not data.Highlight.Adornee or not data.Highlight.Adornee.Parent then
            self:Remove(obj)
        end
    end
    
    -- ESP –¥–ª—è –∏–≥—Ä–æ–∫–æ–≤
    if Config.ESP.Murder or Config.ESP.Sheriff or Config.ESP.Innocent then
        for _, player in pairs(GetPlayers()) do
            if player ~= game.Players.LocalPlayer then
                local char = GetCharacter(player)
                if char and char:FindFirstChild("HumanoidRootPart") then
                    if IsMurder(player) and Config.ESP.Murder then
                        self:Add(char, ESPColors.Murder, "üî™ Murder: " .. player.Name)
                    elseif IsSheriff(player) and Config.ESP.Sheriff then
                        self:Add(char, ESPColors.Sheriff, "üëÆ Sheriff: " .. player.Name)
                    elseif Config.ESP.Innocent then
                        self:Add(char, ESPColors.Innocent, "üòá Innocent: " .. player.Name)
                    end
                end
            end
        end
    end
    
    -- ESP –¥–ª—è –æ—Ä—É–∂–∏—è
    if Config.ESP.Gun then
        local gun = FindGun()
        if gun then
            self:Add(gun, ESPColors.Gun, "üî´ Gun")
        end
    end
end

-- –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ WindUI
local Window = WindUI:CreateWindow({
    Name = "Murder Mystery 2+",
    Size = UDim2.fromOffset(550, 400),
    Color = Color3.fromRGB(30, 30, 40),
    Theme = "Dark"
})

-- –í–∫–ª–∞–¥–∫–∞ ESP
local ESPTab = Window:CreateTab("ESP", "üîç")

ESPTab:CreateToggle("Murder ESP", {
    Default = Config.ESP.Murder,
    Callback = function(value)
        Config.ESP.Murder = value
        if not value then
            ESP:Update()
        end
    end
})

ESPTab:CreateToggle("Sheriff ESP", {
    Default = Config.ESP.Sheriff,
    Callback = function(value)
        Config.ESP.Sheriff = value
        if not value then
            ESP:Update()
        end
    end
})

ESPTab:CreateToggle("Innocent ESP", {
    Default = Config.ESP.Innocent,
    Callback = function(value)
        Config.ESP.Innocent = value
        if not value then
            ESP:Update()
        end
    end
})

ESPTab:CreateToggle("Gun ESP", {
    Default = Config.ESP.Gun,
    Callback = function(value)
        Config.ESP.Gun = value
        if not value then
            ESP:Update()
        end
    end
})

ESPTab:CreateButton("Clear ESP", {
    Callback = function()
        ESP:Clear()
        WindUI:Notify("ESP –æ—á–∏—â–µ–Ω", "–í—Å–µ ESP –º–µ—Ç–∫–∏ –±—ã–ª–∏ —É–¥–∞–ª–µ–Ω—ã")
    end
})

-- –í–∫–ª–∞–¥–∫–∞ Murder
local MurderTab = Window:CreateTab("Murder", "üî™")

MurderTab:CreateSection("–£–±–∏–π—Å—Ç–≤–∞")

MurderTab:CreateButton("–£–±–∏—Ç—å –≤—Å–µ—Ö", {
    Callback = function()
        local localPlayer = game.Players.LocalPlayer
        if IsMurder(localPlayer) then
            for _, player in pairs(GetPlayers()) do
                if player ~= localPlayer then
                    local char = GetCharacter(player)
                    if char then
                        -- –ó–¥–µ—Å—å –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ª–æ–≥–∏–∫–∞ —É–±–∏–π—Å—Ç–≤–∞
                        WindUI:Notify("Murder", "–ü–æ–ø—ã—Ç–∫–∞ —É–±–∏—Ç—å " .. player.Name)
                    end
                end
            end
        else
            WindUI:Notify("–û—à–∏–±–∫–∞", "–í—ã –Ω–µ Murder!", Color3.fromRGB(255, 50, 50))
        end
    end
})

MurderTab:CreateButton("–£–±–∏—Ç—å Sheriff", {
    Callback = function()
        local localPlayer = game.Players.LocalPlayer
        if IsMurder(localPlayer) then
            for _, player in pairs(GetPlayers()) do
                if player ~= localPlayer and IsSheriff(player) then
                    WindUI:Notify("Murder", "–ù–∞–π–¥–µ–Ω Sheriff: " .. player.Name)
                    -- –õ–æ–≥–∏–∫–∞ —É–±–∏–π—Å—Ç–≤–∞ Sheriff
                    break
                end
            end
        else
            WindUI:Notify("–û—à–∏–±–∫–∞", "–í—ã –Ω–µ Murder!")
        end
    end
})

MurderTab:CreateSection("–¢–µ–ª–µ–ø–æ—Ä—Ç–∞—Ü–∏—è")

MurderTab:CreateButton("–¢–µ–ª–µ–ø–æ—Ä—Ç –∫ Sheriff", {
    Callback = function()
        for _, player in pairs(GetPlayers()) do
            if IsSheriff(player) then
                local char = GetCharacter(player)
                local localChar = GetCharacter(game.Players.LocalPlayer)
                if char and localChar then
                    localChar:SetPrimaryPartCFrame(char.PrimaryPart.CFrame * CFrame.new(0, 0, 3))
                    WindUI:Notify("–¢–µ–ª–µ–ø–æ—Ä—Ç", "–ö Sheriff: " .. player.Name)
                    break
                end
            end
        end
    end
})

-- –í–∫–ª–∞–¥–∫–∞ Sheriff
local SheriffTab = Window:CreateTab("Sheriff", "üëÆ")

SheriffTab:CreateSection("–î–µ–π—Å—Ç–≤–∏—è")

SheriffTab:CreateButton("–£–±–∏—Ç—å Murder", {
    Callback = function()
        local localPlayer = game.Players.LocalPlayer
        if IsSheriff(localPlayer) then
            for _, player in pairs(GetPlayers()) do
                if player ~= localPlayer and IsMurder(player) then
                    WindUI:Notify("Sheriff", "–ù–∞–π–¥–µ–Ω Murder: " .. player.Name)
                    -- –õ–æ–≥–∏–∫–∞ —É–±–∏–π—Å—Ç–≤–∞ Murder
                    break
                end
            end
        else
            WindUI:Notify("–û—à–∏–±–∫–∞", "–í—ã –Ω–µ Sheriff!")
        end
    end
})

SheriffTab:CreateButton("–í—ã—Å—Ç—Ä–µ–ª–∏—Ç—å –≤ Murder", {
    Callback = function()
        if IsSheriff(game.Players.LocalPlayer) then
            WindUI:Notify("Sheriff", "–í—ã—Å—Ç—Ä–µ–ª –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω")
            -- –õ–æ–≥–∏–∫–∞ –≤—ã—Å—Ç—Ä–µ–ª–∞
        end
    end
})

SheriffTab:CreateButton("–¢–µ–ª–µ–ø–æ—Ä—Ç –∫ Murder", {
    Callback = function()
        for _, player in pairs(GetPlayers()) do
            if IsMurder(player) then
                local char = GetCharacter(player)
                local localChar = GetCharacter(game.Players.LocalPlayer)
                if char and localChar then
                    localChar:SetPrimaryPartCFrame(char.PrimaryPart.CFrame * CFrame.new(0, 0, 5))
                    WindUI:Notify("–¢–µ–ª–µ–ø–æ—Ä—Ç", "–ö Murder: " .. player.Name)
                    break
                end
            end
        end
    end
})

-- –í–∫–ª–∞–¥–∫–∞ Innocent
local InnocentTab = Window:CreateTab("Innocent", "üòá")

InnocentTab:CreateSection("–û—Ä—É–∂–∏–µ")

InnocentTab:CreateButton("–í–∑—è—Ç—å –æ—Ä—É–∂–∏–µ", {
    Callback = function()
        local gun = FindGun()
        if gun then
            local localChar = GetCharacter(game.Players.LocalPlayer)
            if localChar then
                gun.CFrame = localChar.HumanoidRootPart.CFrame
                WindUI:Notify("Innocent", "–ü—ã—Ç–∞—é—Å—å –≤–∑—è—Ç—å –æ—Ä—É–∂–∏–µ")
            end
        else
            WindUI:Notify("Innocent", "–û—Ä—É–∂–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ")
        end
    end
})

InnocentTab:CreateToggle("–ê–≤—Ç–æ-–≤–∑—è—Ç–∏–µ –æ—Ä—É–∂–∏—è", {
    Default = Config.Innocent.AutoGrabGun,
    Callback = function(value)
        Config.Innocent.AutoGrabGun = value
        WindUI:Notify("Auto Grab", value and "–í–∫–ª—é—á–µ–Ω–æ" or "–í—ã–∫–ª—é—á–µ–Ω–æ")
    end
})

InnocentTab:CreateSection("–ß–∞—Ç")

InnocentTab:CreateButton("–ù–∞–ø–∏—Å–∞—Ç—å Murder –≤ —á–∞—Ç", {
    Callback = function()
        for _, player in pairs(GetPlayers()) do
            if IsMurder(player) then
                game:GetService("ReplicatedStorage").DefaultChatSystemChatEvents.SayMessageRequest:FireServer(
                    "üî™ Murder is: " .. player.Name, "All"
                )
                WindUI:Notify("–ß–∞—Ç", "Murder –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –≤ —á–∞—Ç")
                break
            end
        end
    end
})

InnocentTab:CreateButton("–ù–∞–ø–∏—Å–∞—Ç—å Sheriff –≤ —á–∞—Ç", {
    Callback = function()
        for _, player in pairs(GetPlayers()) do
            if IsSheriff(player) then
                game:GetService("ReplicatedStorage").DefaultChatSystemChatEvents.SayMessageRequest:FireServer(
                    "üëÆ Sheriff is: " .. player.Name, "All"
                )
                WindUI:Notify("–ß–∞—Ç", "Sheriff –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –≤ —á–∞—Ç")
                break
            end
        end
    end
})

-- –í–∫–ª–∞–¥–∫–∞ Misc
local MiscTab = Window:CreateTab("Misc", "‚öôÔ∏è")

-- –°–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤ –¥–ª—è –≤—ã–±–æ—Ä–∞
local playerList = {}
for _, player in pairs(GetPlayers()) do
    if player ~= game.Players.LocalPlayer then
        table.insert(playerList, player.Name)
    end
end

MiscTab:CreateSection("–ò–≥—Ä–æ–∫–∏")

local PlayerDropdown = MiscTab:CreateDropdown("–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä–æ–∫–∞", {
    List = playerList,
    Default = "",
    Callback = function(value)
        Config.Misc.FlingPlayer = value
    end
})

MiscTab:CreateButton("–§–ª–∏–Ω–≥ –∏–≥—Ä–æ–∫–∞", {
    Callback = function()
        if Config.Misc.FlingPlayer and Config.Misc.FlingPlayer ~= "" then
            WindUI:Notify("–§–ª–∏–Ω–≥", "–§–ª–∏–Ω–≥ –∏–≥—Ä–æ–∫–∞: " .. Config.Misc.FlingPlayer)
            -- –õ–æ–≥–∏–∫–∞ —Ñ–ª–∏–Ω–≥–∞
        else
            WindUI:Notify("–û—à–∏–±–∫–∞", "–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä–æ–∫–∞!")
        end
    end
})

MiscTab:CreateButton("–§–ª–∏–Ω–≥ –≤—Å–µ—Ö", {
    Callback = function()
        WindUI:Notify("–§–ª–∏–Ω–≥", "–§–ª–∏–Ω–≥ –≤—Å–µ—Ö –∏–≥—Ä–æ–∫–æ–≤")
        -- –õ–æ–≥–∏–∫–∞ —Ñ–ª–∏–Ω–≥–∞ –≤—Å–µ—Ö
    end
})

MiscTab:CreateSection("–°–µ—Ä–≤–µ—Ä")

MiscTab:CreateButton("–°–º–µ–Ω–∏—Ç—å —Å–µ—Ä–≤–µ—Ä", {
    Callback = function()
        WindUI:Notify("–°–µ—Ä–≤–µ—Ä", "–ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ –¥—Ä—É–≥–æ–π —Å–µ—Ä–≤–µ—Ä...")
        -- –õ–æ–≥–∏–∫–∞ —Å–º–µ–Ω—ã —Å–µ—Ä–≤–µ—Ä–∞
    end
})

MiscTab:CreateButton("–ü–µ—Ä–µ–∑–∞–π—Ç–∏", {
    Callback = function()
        WindUI:Notify("–ü–µ—Ä–µ–∑–∞—Ö–æ–¥", "–ü–µ—Ä–µ–∑–∞—Ö–æ–¥ –≤ –∏–≥—Ä—É...")
        game:GetService("TeleportService"):TeleportToPlaceInstance(
            game.PlaceId,
            game.JobId,
            game.Players.LocalPlayer
        )
    end
})

MiscTab:CreateSection("–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è")

MiscTab:CreateLabel("–ò–≥—Ä–æ–∫–æ–≤ –æ–Ω–ª–∞–π–Ω: " .. #GetPlayers())
MiscTab:CreateLabel("–ú–µ—Å—Ç–æ: Murder Mystery 2")

-- –í–∫–ª–∞–¥–∫–∞ Config
local ConfigTab = Window:CreateTab("Config", "üìÅ")

ConfigTab:CreateSection("–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ")

ConfigTab:CreateButton("–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥", {
    Callback = function()
        -- –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
        WindUI:Notify("–ö–æ–Ω—Ñ–∏–≥", "–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞")
    end
})

ConfigTab:CreateButton("–ó–∞–≥—Ä—É–∑–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥", {
    Callback = function()
        -- –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –∑–∞–≥—Ä—É–∑–∫–∏
        WindUI:Notify("–ö–æ–Ω—Ñ–∏–≥", "–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∑–∞–≥—Ä—É–∂–µ–Ω–∞")
    end
})

ConfigTab:CreateButton("–°–±—Ä–æ—Å–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥", {
    Callback = function()
        Config = {
            ESP = {
                Murder = true,
                Sheriff = true,
                Innocent = true,
                Gun = true
            },
            Innocent = {
                AutoGrabGun = false
            }
        }
        WindUI:Notify("–ö–æ–Ω—Ñ–∏–≥", "–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–±—Ä–æ—à–µ–Ω–∞")
    end
})

ConfigTab:CreateSection("–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∫—Ä–∏–ø—Ç–µ")

ConfigTab:CreateLabel("Murder Mystery 2+")
ConfigTab:CreateLabel("–í–µ—Ä—Å–∏—è: 2.0")
ConfigTab:CreateLabel("–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å: WindUI")

-- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∏–≥—Ä–æ–∫–æ–≤ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏
game.Players.PlayerAdded:Connect(function(player)
    table.insert(playerList, player.Name)
    PlayerDropdown:UpdateList(playerList)
end)

game.Players.PlayerRemoving:Connect(function(player)
    for i, name in ipairs(playerList) do
        if name == player.Name then
            table.remove(playerList, i)
            break
        end
    end
    PlayerDropdown:UpdateList(playerList)
end)

-- –û—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è ESP
local ESPLoop
ESPLoop = game:GetService("RunService").RenderStepped:Connect(function()
    ESP:Update()
    
    -- –ê–≤—Ç–æ-–≤–∑—è—Ç–∏–µ –æ—Ä—É–∂–∏—è
    if Config.Innocent.AutoGrabGun then
        local gun = FindGun()
        local localChar = GetCharacter(game.Players.LocalPlayer)
        if gun and localChar and not IsSheriff(game.Players.LocalPlayer) then
            gun.CFrame = localChar.HumanoidRootPart.CFrame
        end
    end
end)

-- –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –ø—Ä–∏ –æ—Ç–∫–ª—é—á–µ–Ω–∏–∏
game.Players.LocalPlayer.CharacterAdded:Connect(function()
    ESP:Clear()
end)

game.Players.LocalPlayer.CharacterRemoving:Connect(function()
    ESP:Clear()
end)

-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –∑–∞–≥—Ä—É–∑–∫–µ
WindUI:Notify("Murder Mystery 2+", "–°–∫—Ä–∏–ø—Ç —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω!", Color3.fromRGB(50, 255, 50))
