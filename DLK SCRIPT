local Rayfield = loadstring(game:HttpGet('https://raw.githubusercontent.com/shlexware/Rayfield/main/source'))()
local Window = Rayfield:CreateWindow({
    Name = "Casual Stock (beta) FREE",
    LoadingTitle = "Загрузка...",
    LoadingSubtitle = "by DADILK",
    ConfigurationSaving = {
        Enabled = true,
        FolderName = "RayfieldESP",
        FileName = "Config.json"
    }
})

-- Включение ESP
local ESPToggle = Window:CreateToggle({
    Name = "Включить ESP",
    CurrentValue = false,
    Flag = "ESPEnabled",
    Callback = function(Value)
        if Value then
            StartESP()
        else
            ClearESP()
        end
    end
})

-- Цвет ESP (если используем Highlight)
local ESPColor = Window:CreateColorPicker({
    Name = "Цвет подсветки",
    Color = Color3.fromRGB(0, 255, 0), -- Зеленый по умолчанию
    Flag = "ESPColor",
    Callback = function(Color)
        UpdateESPColor(Color)
    end
})

-- Дистанция видимости
local ESPDistance = Window:CreateSlider({
    Name = "Дистанция видимости",
    Range = {10, 500},
    Increment = 10,
    Suffix = "studs",
    CurrentValue = 100,
    Flag = "ESPDistance",
    Callback = function(Value)
        -- Можно обновлять проверку дистанции
    end
})

-- Функция для создания ESP
local function CreateESP(item, text, color)
    if not item:FindFirstChild("ESP_Highlight") then
        local highlight = Instance.new("Highlight")
        highlight.Name = "ESP_Highlight"
        highlight.FillColor = color or ESPColor.CurrentValue
        highlight.OutlineColor = Color3.new(1, 1, 1)
        highlight.FillTransparency = 0.5
        highlight.Parent = item
    end
end

-- Функция для очистки ESP
local function ClearESP()
    for _, item in ipairs(workspace:GetDescendants()) do
        if item:FindFirstChild("ESP_Highlight") then
            item.ESP_Highlight:Destroy()
        end
    end
end

-- Обновление цвета ESP
local function UpdateESPColor(color)
    for _, item in ipairs(workspace:GetDescendants()) do
        if item:FindFirstChild("ESP_Highlight") then
            item.ESP_Highlight.FillColor = color
        end
    end
end

-- Поиск и подсветка предметов
local function StartESP()
    while Rayfield.Flags["ESPEnabled"].CurrentValue do
        task.wait(1) -- Оптимизация: проверяем раз в секунду

        for _, item in ipairs(workspace:GetDescendants()) do
            if item:IsA("BasePart") or item:IsA("MeshPart") then
                -- Ищем предметы по имени (можно добавить свои ключевые слова)
                if item.Name:lower():find("money") 
                    or item.Name:lower():find("diamond") 
                    or item.Name:lower():find("gold") 
                then
                    CreateESP(item, item.Name)
                end
            end
        end
    end
end
